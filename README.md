# Клиент для работы с SFTP-сервером

## Описание проекта

Проект представляет собой SFTP-клиент для работы с данными на удаленном сервере. Пользователь может подключиться к серверу посредством конфигурационного файла, считать данные из json-файла на сервере, и управлять ими с помощью доступных команд. Программа поддерживает операции по добавлению, удалению и получению информации о доменах и IP-адресах, а также проверку их валидности. Все изменения, сделанные через команды, сохраняются на сервере. В проекте реализована система тестирования для проверки успешности подключения, обработки данных и корректности работы функций.

## Основной функционал
- **Подключение к SFTP-серверу.**  
  При запуске приложение запрашивает у пользователя параметры подключения (адрес сервера, порт, логин и пароль) и устанавливает соединение с использованием библиотеки [JSch](http://www.jcraft.com/jsch/).
- **Работа с JSON-файлом на сервере.**  
  Приложение находит JSON-файл (с расширением `.json`) в текущей директории сервера, содержащий список domain-IP пар, и считывает его содержимое для дальнейшей обработки.
- **Получение и вывод списка domain-IP пар.**  
  При выборе соответствующего пункта меню приложение извлекает пары из JSON-файла, сортирует их по домену и выводит на экран.
- **Поиск IP по домену.**  
  Пользователь может ввести домен, после чего приложение ищет соответствующую пару и выводит связанный IP-адрес.
- **Поиск домена по IP.**  
  Приложение позволяет ввести IP-адрес (с предварительной нормализацией, то есть удалением ведущих нулей) и вернуть соответствующий домен.
- **Добавление новой domain-IP пары.**  
  Приложение поддерживает добавление новой пары с проверкой корректности введённых данных:  
  - Проверяется, что доменное имя не пустое.  
  - Выполняется валидация формата IP-адреса.  
  - Осуществляется проверка на дублирование (если домен или IP уже присутствуют в файле).
- **Удаление существующей domain-IP пары.**  
  Пользователь может удалить пару, введя либо домен, либо IP. Приложение находит и удаляет соответствующую запись.
- **Обновление JSON-файла на сервере.**  
  После добавления или удаления записей приложение формирует новый JSON и перезаписывает исходный файл на SFTP-сервере.
- **Интерактивное меню.**  
  Пользовательский интерфейс в консоли предоставляет следующие опции:
  1. Получить domain-IP пары.
  2. Получить IP по domain.
  3. Получить domain по IP.
  4. Добавить новую domain-IP пару.
  5. Удалить domain-IP пару.
  6. Выход из приложения.

## Требования
Для работы с проектом необходимы следующие инструменты:

- [Maven](https://maven.apache.org/) версии 3.0.5 и выше (для сборки проекта);
- [Java SE](https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html) версии 8.


## Инструкция по сборке проекта
1. Клонировать репозиторий:
```bash
git clone https://github.com/polinio/SFTPClient.git
```
2. Перейти в каталог с конфигурационным файлом:
```bash
cd SFTPClient/src/main/resources
```
3. Отредактировать файл config.properties, подставив свои параметры для подключения к SFTP серверу:

*для Windows:*
```bash
notepad config.properties
```
*для Linux:*
```bash
nano config.properties
```

4. Вернуться в корневую директорию проекта:
```bash
cd ../../..
```
5. Установить зависимости (без тестов):
```bash
mvn install -DskipTests
```
6. Собрать проект (без тестов):
```bash
mvn clean package -DskipTests
```
7. Проверить работоспособность клиента с помощью исполняемого файла:
```bash
java -jar cli.jar
```
    
## Инструкция по работе с приложением
1. Запустите исполняемый jar-файл клиента (см. выше).
2. Следуйте подсказкам в меню и введите данные для подключения к серверу.
3. После успешного подключения данные из файла будут импортированы, и Вам будут предложены доступные команды с аргументами.
4. Все изменения, выполненные через команды, будут автоматически сохранены на сервере.

## Инструкция по запуску тестов
Для запуска тестов используйте команду:
```bash
mvn test
```
Или запустите тесты с помощью исполняемого файла:
```bash
java -jar test.jar
```
### Обоснование тестов
В данном наборе тестов проверяется функциональность класса SFTPClient, реализующего работу с доменами и IP-адресами через SFTP-сервер. Тесты охватывают основные сценарии работы с методами клиента и включают следующие направления:
- **Подключение к SFTP-серверу:**
Тестируется успешное подключение к серверу и проверка состояния канала после подключения (`testConnectSuccess`).
- **Получение IP по домену:**
Проверка правильности получения IP-адреса для существующего домена и корректности обработки регистра в доменах (`testGetIPByDomainSuccess` и `testGetIPByDomainCaseInsensitive`).
Проверка поведения метода при попытке получить IP для несуществующего домена (`testGetIPByDomainNotFound`).
- **Получение домена по IP:**
Проверяется корректность получения домена для действительного IP-адреса, а также обработка различных форматов записи IP (`testGetDomainByIPSuccess`, `testGetDomainByIPCaseInsensitive`).
Тест на обработку случая, когда IP не существует (`testGetDomainByIPNotFound`).
- **Валидация IP-адресов:**
Проверяется, что метод правильно идентифицирует валидные и невалидные IP-адреса, а также пустые строки и строки с неправильным форматом (`testIsValidIPSuccess`, `testIsValidIPFailure`, `testIsValidIPEmpty`, `testIsValidIPInvalidFormat`).
- **Добавление и проверка пар домен-IP:**
Тестируется добавление новых пар доменов и IP-адресов, в том числе проверка на дубликаты доменов и IP, а также добавление неправильных значений (невалидных IP и пустых строк) (`testAddPairSuccess`, `testAddPairDuplicateDomain`, `testAddPairDuplicateIP`, `testAddPairInvalidIP`, `testAddPairEmptyDomain`, `testAddPairEmptyIP`).
- **Удаление пар домен-IP:**
Проверяется удаление пар доменов и IP-адресов, с подтверждением, что удаление выполняется корректно и что после удаления попытки получить информацию о домене или IP возвращают сообщение об отсутствии данных (`testDeletePairSuccess`).

По моему мнению, каждый тест направлен на проверку корректности работы отдельных методов с различными сценариями, включая успешные случаи, граничные условия и ошибки, что обеспечивает надежность и устойчивость системы к нештатным ситуациям.
## Примечания
Убедитесь, что параметры в config.properties правильны и соответствуют вашим настройкам сервера SFTP.
